<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotel Automation ROI Calculator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #54ACBF 0%, #26658C 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #54ACBF 0%, #26658C 100%);
            color: white;
            padding: 40px;
            text-align: center;
            position: relative;
        }
        
        .logo {
            font-size: 3.5em;
            font-weight: 300;
            letter-spacing: 8px;
            margin-bottom: 5px;
            color: #A7EBF2;
        }
        
        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
            font-weight: 500;
            color: white;
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.9;
            font-weight: 300;
        }
        
        .footer-note {
            margin-top: 15px;
            font-size: 0.9em;
            opacity: 0.8;
            font-weight: 300;
        }
        
        .content {
            padding: 40px;
        }
        
        .section {
            margin-bottom: 40px;
            padding: 30px;
            background: #f8f9ff;
            border-radius: 15px;
            border-left: 5px solid #54ACBF;
        }
        
        .section h2 {
            color: #26658C;
            margin-bottom: 20px;
            font-size: 1.8em;
            font-weight: 600;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 500;
            font-size: 1em;
        }
        
        .input-group input, .input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            font-family: 'Poppins', sans-serif;
            transition: border-color 0.3s;
        }
        
        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #54ACBF;
        }
        
        .input-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .currency-selector {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: white;
            border-radius: 10px;
        }
        
        .currency-selector label {
            font-weight: 500;
            color: #26658C;
        }
        
        .currency-selector select {
            padding: 8px 15px;
            border: 2px solid #54ACBF;
            border-radius: 6px;
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
            color: #26658C;
            cursor: pointer;
        }
        
        .results {
            background: linear-gradient(135deg, #54ACBF 0%, #26658C 100%);
            color: white;
            padding: 40px;
            border-radius: 15px;
            margin-top: 30px;
        }
        
        .results h2 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2em;
            font-weight: 600;
            color: white;
        }
        
        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .metric-card {
            background: rgba(167, 235, 242, 0.15);
            backdrop-filter: blur(10px);
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .metric-card h3 {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 500;
        }
        
        .metric-card .value {
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .metric-card .subtext {
            font-size: 0.9em;
            opacity: 0.8;
            font-weight: 300;
        }
        
        .comparison {
            background: white;
            color: #333;
            padding: 30px;
            border-radius: 12px;
            margin-top: 20px;
        }
        
        .comparison h3 {
            color: #26658C;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
        }
        
        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .comparison-col {
            padding: 20px;
            border-radius: 8px;
        }
        
        .current {
            background: #ffe0e0;
        }
        
        .automated {
            background: #e0ffe0;
        }
        
        .comparison-col h4 {
            margin-bottom: 15px;
            text-align: center;
            font-weight: 600;
        }
        
        .comparison-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(0,0,0,0.1);
            font-size: 0.95em;
        }
        
        .recommendations {
            background: #fff3cd;
            padding: 25px;
            border-radius: 12px;
            margin-top: 20px;
            color: #856404;
        }
        
        .recommendations h3 {
            margin-bottom: 15px;
            color: #856404;
            font-weight: 600;
        }
        
        .recommendations ul {
            list-style-position: inside;
            line-height: 1.8;
        }
        
        .cta-section {
            background: #f8f9ff;
            padding: 40px;
            text-align: center;
            border-radius: 15px;
            margin-top: 30px;
        }
        
        .cta-section h2 {
            color: #26658C;
            margin-bottom: 20px;
            font-weight: 600;
        }
        
        .btn {
            display: inline-block;
            padding: 15px 40px;
            background: linear-gradient(135deg, #54ACBF 0%, #26658C 100%);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 600;
            font-family: 'Poppins', sans-serif;
            transition: transform 0.3s, box-shadow 0.3s;
            border: none;
            cursor: pointer;
            margin: 10px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(84, 172, 191, 0.4);
        }
        
        .btn-secondary {
            background: white;
            color: #26658C;
            border: 2px solid #26658C;
        }
        
        .payback-period {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin: 20px 0;
            font-size: 1.3em;
            font-weight: 500;
        }
        
        .help-text {
            font-size: 0.85em;
            color: #666;
            margin-top: 5px;
            font-style: italic;
            font-weight: 300;
        }
        
        .iq-footer {
            text-align: center;
            padding: 30px;
            color: #666;
            font-size: 0.9em;
            border-top: 1px solid #eee;
        }
        
        .iq-footer strong {
            color: #26658C;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .comparison-grid {
                grid-template-columns: 1fr;
            }
            
            .logo {
                font-size: 2.5em;
                letter-spacing: 5px;
            }
            
            .header h1 {
                font-size: 1.5em;
            }
            
            .content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">LUNA</div>
            <h1>Hotel Automation ROI Calculator</h1>
            <p>Discover how much time and money you could save with AI automation</p>
            <div class="footer-note">by IQ Africa</div>
        </div>
        
        <div class="content">
            <!-- Currency Selector -->
            <div class="currency-selector">
                <label for="currency">üí± Select Currency:</label>
                <select id="currency" onchange="updateCurrencyLabels()">
                    <option value="USD">üá∫üá∏ USD ($)</option>
                    <option value="KES" selected>üá∞üá™ KES (KSh)</option>
                    <option value="TZS">üáπüáø TZS (TSh)</option>
                    <option value="UGX">üá∫üá¨ UGX (USh)</option>
                    <option value="RWF">üá∑üáº RWF (RF)</option>
                    <option value="ZAR">üáøüá¶ ZAR (R)</option>
                    <option value="NGN">üá≥üá¨ NGN (‚Ç¶)</option>
                    <option value="EUR">üá™üá∫ EUR (‚Ç¨)</option>
                    <option value="GBP">üá¨üáß GBP (¬£)</option>
                </select>
            </div>

            <!-- Hotel Information -->
            <div class="section">
                <h2>üìã Hotel Information</h2>
                <div class="input-row">
                    <div class="input-group">
                        <label for="hotelName">Hotel/Property Name</label>
                        <input type="text" id="hotelName" placeholder="Enter your hotel name">
                    </div>
                    <div class="input-group">
                        <label for="roomCount">Number of Rooms</label>
                        <input type="number" id="roomCount" value="0" min="1">
                        <div class="help-text">Total number of bookable rooms</div>
                    </div>
                    <div class="input-group">
                        <label for="propertyType">Property Type</label>
                        <select id="propertyType">
                            <option value="hotel">Hotel</option>
                            <option value="resort">Resort</option>
                            <option value="lodge">Safari Lodge</option>
                            <option value="guesthouse">Guesthouse</option>
                            <option value="boutique">Boutique Hotel</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Current Operations -->
            <div class="section">
                <h2>üíº Current Operations</h2>
                <div class="input-row">
                    <div class="input-group">
                        <label for="occupancyRate">Average Occupancy Rate (%)</label>
                        <input type="number" id="occupancyRate" value="0" min="0" max="100">
                        <div class="help-text">Annual average occupancy percentage</div>
                    </div>
                    <div class="input-group">
                        <label for="avgRate">Average Daily Rate (<span class="currency-label">KSh</span>)</label>
                        <input type="number" id="avgRate" value="0" min="0">
                        <div class="help-text">Average price per room per night</div>
                    </div>
                    <div class="input-group">
                        <label for="dailyInquiries">Daily Guest Inquiries</label>
                        <input type="number" id="dailyInquiries" value="0" min="0">
                        <div class="help-text">WhatsApp, email, phone calls per day</div>
                    </div>
                </div>
                
                <div class="input-row">
                    <div class="input-group">
                        <label for="responseTime">Average Response Time (hours)</label>
                        <input type="number" id="responseTime" value="0" min="0" step="0.5">
                        <div class="help-text">Time to respond to guest inquiries</div>
                    </div>
                    <div class="input-group">
                        <label for="staffCount">Staff Handling Inquiries</label>
                        <input type="number" id="staffCount" value="0" min="1">
                        <div class="help-text">Full-time equivalent staff</div>
                    </div>
                    <div class="input-group">
                        <label for="avgSalary">Average Staff Salary (<span class="currency-label">KSh</span>/month)</label>
                        <input type="number" id="avgSalary" value="0" min="0">
                        <div class="help-text">Monthly salary per staff member</div>
                    </div>
                </div>

                <div class="input-row">
                    <div class="input-group">
                        <label for="otaPercentage">Bookings via OTAs (%)</label>
                        <input type="number" id="otaPercentage" value="0" min="0" max="100">
                        <div class="help-text">Percentage from Booking.com, Expedia, etc.</div>
                    </div>
                    <div class="input-group">
                        <label for="otaCommission">OTA Commission Rate (%)</label>
                        <input type="number" id="otaCommission" value="0" min="0" max="30">
                        <div class="help-text">Average commission paid to OTAs</div>
                    </div>
                    <div class="input-group">
                        <label for="conversionRate">Inquiry to Booking Rate (%)</label>
                        <input type="number" id="conversionRate" value="0" min="0" max="100">
                        <div class="help-text">% of inquiries that become bookings</div>
                    </div>
                </div>
            </div>

            <!-- Calculate Button -->
            <div style="text-align: center; margin: 30px 0;">
                <button class="btn" onclick="calculateROI()">üîÆ Calculate My ROI</button>
            </div>

            <!-- Results Section -->
            <div id="resultsSection" style="display: none;">
                <div class="results">
                    <h2>üí∞ Your Automation ROI Results</h2>
                    
                    <div class="metrics">
                        <div class="metric-card">
                            <h3>Annual Savings</h3>
                            <div class="value" id="annualSavings">0</div>
                            <div class="subtext">Total cost reduction</div>
                        </div>
                        <div class="metric-card">
                            <h3>Monthly Savings</h3>
                            <div class="value" id="monthlySavings">0</div>
                            <div class="subtext">Recurring monthly benefit</div>
                        </div>
                        <div class="metric-card">
                            <h3>ROI Percentage</h3>
                            <div class="value" id="roiPercentage">0%</div>
                            <div class="subtext">Return on investment</div>
                        </div>
                        <div class="metric-card">
                            <h3>Payback Period</h3>
                            <div class="value" id="paybackPeriod">0</div>
                            <div class="subtext">Months to break even</div>
                        </div>
                    </div>

                    <div class="payback-period">
                        ‚ö° Your investment pays for itself in <strong><span id="paybackMonths">0</span> months</strong>!
                    </div>

                    <!-- Detailed Comparison -->
                    <div class="comparison">
                        <h3>üìä Current vs. Automated Operations</h3>
                        <div class="comparison-grid">
                            <div class="comparison-col current">
                                <h4>‚ùå Current State</h4>
                                <div class="comparison-item">
                                    <span>Response Time:</span>
                                    <strong><span id="currentResponseTime">0</span> hours</strong>
                                </div>
                                <div class="comparison-item">
                                    <span>Staff Hours/Week:</span>
                                    <strong><span id="currentStaffHours">0</span> hours</strong>
                                </div>
                                <div class="comparison-item">
                                    <span>Monthly Staff Cost:</span>
                                    <strong><span id="currentStaffCost">0</span></strong>
                                </div>
                                <div class="comparison-item">
                                    <span>OTA Commissions/Year:</span>
                                    <strong><span id="currentCommissions">0</span></strong>
                                </div>
                                <div class="comparison-item">
                                    <span>Lost Bookings/Month:</span>
                                    <strong><span id="lostBookings">0</span></strong>
                                </div>
                            </div>
                            
                            <div class="comparison-col automated">
                                <h4>‚úÖ With Automation</h4>
                                <div class="comparison-item">
                                    <span>Response Time:</span>
                                    <strong>4 minutes</strong>
                                </div>
                                <div class="comparison-item">
                                    <span>Staff Hours/Week:</span>
                                    <strong><span id="automatedStaffHours">0</span> hours</strong>
                                </div>
                                <div class="comparison-item">
                                    <span>Monthly Staff Cost:</span>
                                    <strong><span id="automatedStaffCost">0</span></strong>
                                </div>
                                <div class="comparison-item">
                                    <span>OTA Commissions/Year:</span>
                                    <strong><span id="automatedCommissions">0</span></strong>
                                </div>
                                <div class="comparison-item">
                                    <span>Lost Bookings/Month:</span>
                                    <strong>2-3</strong>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Recommendations -->
                    <div class="recommendations">
                        <h3>üéØ Recommended Solutions for <span id="recHotelName"></span></h3>
                        <ul id="recommendationsList"></ul>
                    </div>
                </div>

                <!-- CTA Section -->
                <div class="cta-section">
                    <h2>Ready to Transform Your Hotel Operations?</h2>
                    <p style="margin: 20px 0; font-size: 1.1em; color: #666; font-weight: 400;">
                        Based on your results, you could save <strong><span id="ctaSavings">0</span>/year</strong>. 
                        Let's discuss how to make this happen.
                    </p>
                    <button class="btn" onclick="downloadResults()">üì• Download Full Report</button>
                    <button class="btn btn-secondary" onclick="scheduleCall()">üìû Schedule Free Consultation</button>
                </div>
            </div>
        </div>
        
        <div class="iq-footer">
            Powered by <strong>ServeIQ Africa</strong> | Transforming African Hospitality Through AI
        </div>
    </div>

    <script>
        let currencyRates = {};
        
        // Fetch current exchange rates from the API
        async function fetchExchangeRates() {
            try {
                const response = await fetch('https://v6.exchangerate-api.com/v6/0f500747a06ba8adcdf8d829/latest/USD');
                const data = await response.json();
                if (data.result === 'success') {
                    currencyRates = {
                        USD: 1, // Base currency
                        KES: data.conversion_rates.KES,
                        TZS: data.conversion_rates.TZS,
                        UGX: data.conversion_rates.UGX,
                        RWF: data.conversion_rates.RWF,
                        ZAR: data.conversion_rates.ZAR,
                        NGN: data.conversion_rates.NGN,
                        EUR: data.conversion_rates.EUR,
                        GBP: data.conversion_rates.GBP
                    };
                    console.log('Exchange rates updated successfully');
                    return true;
                } else {
                    throw new Error('Failed to fetch exchange rates');
                }
            } catch (error) {
                console.error('Error fetching exchange rates:', error);
                // Fallback to some default rates if API fails
                currencyRates = {
                    USD: 1,
                    KES: 129,
                    TZS: 2600,
                    UGX: 3700,
                    RWF: 1300,
                    ZAR: 18,
                    NGN: 1550,
                    EUR: 0.92,
                    GBP: 0.79
                };
                alert('Unable to fetch current exchange rates. Using fallback rates.');
                return false;
            }
        }

        const currencySymbols = {
            USD: '$',
            KES: 'KSh',
            TZS: 'TSh',
            UGX: 'USh',
            RWF: 'RF',
            ZAR: 'R',
            NGN: '‚Ç¶',
            EUR: '‚Ç¨',
            GBP: '¬£'
        };

        function updateCurrencyLabels() {
            const currency = document.getElementById('currency').value;
            const symbol = currencySymbols[currency];
            const labels = document.querySelectorAll('.currency-label');
            labels.forEach(label => label.textContent = symbol);
            
            // Update default values based on currency
            const rate = currencyRates[currency];
            document.getElementById('avgRate').value = 0;
            document.getElementById('avgSalary').value = 0;
        }

        function formatCurrency(amount, currency) {
            const symbol = currencySymbols[currency];
            return symbol + Math.round(amount).toLocaleString();
        }

        function calculateROI() {
            const currency = document.getElementById('currency').value;
            const rate = currencyRates[currency];
            
            // Get input values
            const hotelName = document.getElementById('hotelName').value || 'Your Hotel';
            const roomCount = parseFloat(document.getElementById('roomCount').value);
            const occupancyRate = parseFloat(document.getElementById('occupancyRate').value) / 100;
            const avgRate = parseFloat(document.getElementById('avgRate').value);
            const dailyInquiries = parseFloat(document.getElementById('dailyInquiries').value);
            const responseTime = parseFloat(document.getElementById('responseTime').value);
            const staffCount = parseFloat(document.getElementById('staffCount').value);
            const avgSalary = parseFloat(document.getElementById('avgSalary').value);
            const otaPercentage = parseFloat(document.getElementById('otaPercentage').value) / 100;
            const otaCommission = parseFloat(document.getElementById('otaCommission').value) / 100;
            const conversionRate = parseFloat(document.getElementById('conversionRate').value) / 100;

            // Calculations
            const annualRevenue = roomCount * 365 * occupancyRate * avgRate;
            const monthlyRevenue = annualRevenue / 12;
            
            // Staff cost savings
            const currentStaffCost = staffCount * avgSalary;
            const staffSavings = currentStaffCost * 0.6;
            const annualStaffSavings = staffSavings * 12;

            // OTA commission savings
            const currentOTACommissions = annualRevenue * otaPercentage * otaCommission;
            const otaSavings = currentOTACommissions * 0.20;

            // Increased bookings
            const monthlyInquiries = dailyInquiries * 30;
            const currentBookings = monthlyInquiries * conversionRate;
            const improvedConversionRate = conversionRate * 1.10;
            const newBookings = monthlyInquiries * improvedConversionRate;
            const additionalBookings = newBookings - currentBookings;
            const additionalRevenue = additionalBookings * avgRate * 2.5 * 12;

            // Total savings
            const totalAnnualSavings = annualStaffSavings + otaSavings + additionalRevenue;
            const monthlySavings = totalAnnualSavings / 12;

            // Investment
            let setupCost = 1200 * rate;
            let monthlyFee = 150 * rate;
            
            if (roomCount < 30) {
                setupCost = 800 * rate;
                monthlyFee = 100 * rate;
            } else if (roomCount > 100) {
                setupCost = 2500 * rate;
                monthlyFee = 800 * rate;
            }

            const annualInvestment = setupCost + (monthlyFee * 12);
            const netAnnualBenefit = totalAnnualSavings - annualInvestment;
            const roiPercentage = (netAnnualBenefit / annualInvestment) * 100;
            const paybackMonths = setupCost / (monthlySavings - monthlyFee);

            // Staff hours
            const hoursPerInquiry = 0.15;
            const currentWeeklyHours = dailyInquiries * hoursPerInquiry * 7;
            const automatedWeeklyHours = currentWeeklyHours * 0.4;

            // Lost bookings
            const lostBookingsPerMonth = Math.round(monthlyInquiries * 0.05);

            // Update UI
            document.getElementById('annualSavings').textContent = formatCurrency(totalAnnualSavings, currency);
            document.getElementById('monthlySavings').textContent = formatCurrency(monthlySavings, currency);
            document.getElementById('roiPercentage').textContent = Math.round(roiPercentage) + '%';
            document.getElementById('paybackPeriod').textContent = Math.ceil(paybackMonths);
            document.getElementById('paybackMonths').textContent = Math.ceil(paybackMonths);

            // Current vs Automated
            document.getElementById('currentResponseTime').textContent = responseTime;
            document.getElementById('currentStaffHours').textContent = Math.round(currentWeeklyHours);
            document.getElementById('currentStaffCost').textContent = formatCurrency(currentStaffCost, currency);
            document.getElementById('currentCommissions').textContent = formatCurrency(currentOTACommissions, currency);
            document.getElementById('lostBookings').textContent = lostBookingsPerMonth;

            document.getElementById('automatedStaffHours').textContent = Math.round(automatedWeeklyHours);
            document.getElementById('automatedStaffCost').textContent = formatCurrency(currentStaffCost - staffSavings, currency);
            document.getElementById('automatedCommissions').textContent = formatCurrency(currentOTACommissions - otaSavings, currency);

            // Recommendations
            document.getElementById('recHotelName').textContent = hotelName;
            const recommendations = [];
            
            if (responseTime > 2) {
                recommendations.push('ü§ñ <strong>WhatsApp Chatbot</strong> - Reduce response time from ' + responseTime + ' hours to 4 minutes');
            }
            if (otaPercentage > 0.5) {
                recommendations.push('üì± <strong>Direct Booking System</strong> - Save ' + formatCurrency(otaSavings, currency) + '/year in OTA commissions');
            }
            if (staffCount >= 3) {
                recommendations.push('‚öôÔ∏è <strong>Operations Automation</strong> - Free up ' + Math.round(currentWeeklyHours * 0.6) + ' hours/week of staff time');
            }
            if (dailyInquiries > 20) {
                recommendations.push('üí¨ <strong>Multi-Channel Communication Hub</strong> - Handle all inquiries from one dashboard');
            }
            recommendations.push('üí∞ <strong>Dynamic Pricing Engine</strong> - Optimize rates based on demand and competition');
            recommendations.push('‚≠ê <strong>Review Management</strong> - Automated monitoring and response to guest reviews');

            document.getElementById('recommendationsList').innerHTML = recommendations.map(r => '<li>' + r + '</li>').join('');
            document.getElementById('ctaSavings').textContent = formatCurrency(totalAnnualSavings, currency);

            // Show results
            document.getElementById('resultsSection').style.display = 'block';
            document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth' });
        }

        function downloadResults() {
            const wb = XLSX.utils.book_new();
            const currency = document.getElementById('currency').value;
            const symbol = currencySymbols[currency];
            
            const summary = [
                ['HOTEL AUTOMATION ROI REPORT', ''],
                ['Generated:', new Date().toLocaleDateString()],
                ['Hotel Name:', document.getElementById('hotelName').value || 'Your Hotel'],
                ['Currency:', currency],
                [''],
                ['KEY METRICS', ''],
                ['Annual Savings:', document.getElementById('annualSavings').textContent],
                ['Monthly Savings:', document.getElementById('monthlySavings').textContent],
                ['ROI Percentage:', document.getElementById('roiPercentage').textContent],
                ['Payback Period:', document.getElementById('paybackPeriod').textContent + ' months'],
                [''],
                ['CURRENT STATE VS AUTOMATED', ''],
                ['Metric', 'Current', 'With Automation', 'Improvement'],
                ['Response Time', document.getElementById('currentResponseTime').textContent + ' hours', '4 minutes', '98% faster'],
                ['Staff Hours/Week', document.getElementById('currentStaffHours').textContent, document.getElementById('automatedStaffHours').textContent, '60% reduction'],
                ['Monthly Staff Cost', document.getElementById('currentStaffCost').textContent, document.getElementById('automatedStaffCost').textContent, '60% savings'],
                ['Annual OTA Commissions', document.getElementById('currentCommissions').textContent, document.getElementById('automatedCommissions').textContent, '20% reduction'],
                [''],
                ['NEXT STEPS', ''],
                ['1. Schedule a free consultation to discuss implementation'],
                ['2. Choose your automation package based on recommendations'],
                ['3. Begin implementation (typically 2-3 weeks)'],
                ['4. Start seeing ROI within 60-90 days'],
                [''],
                ['Contact: IQ Africa'],
                ['WhatsApp: [Your Number]'],
                ['Email: [Your Email]']
            ];
            
            const ws = XLSX.utils.aoa_to_sheet(summary);
            ws['!cols'] = [{wch: 30}, {wch: 20}, {wch: 20}, {wch: 20}];
            XLSX.utils.book_append_sheet(wb, ws, 'ROI Summary');
            
            XLSX.writeFile(wb, 'Hotel_Automation_ROI_Report_' + document.getElementById('hotelName').value.replace(/\s/g, '_') + '.xlsx');
        }

        function scheduleCall() {
            alert('Great! This would typically open your booking calendar (Calendly, Cal.com, etc.)\n\nFor now, please contact us at:\nWhatsApp: +254XXXXXXXXX\nEmail: hello@iqafrica.com');
        }

        // Initialize currency labels and fetch exchange rates on load
        window.onload = async function() {
            // Show loading indicator
            const loadingDiv = document.createElement('div');
            loadingDiv.id = 'exchangeRateLoading';
            loadingDiv.style.position = 'fixed';
            loadingDiv.style.top = '10px';
            loadingDiv.style.right = '10px';
            loadingDiv.style.padding = '10px';
            loadingDiv.style.background = '#54ACBF';
            loadingDiv.style.color = 'white';
            loadingDiv.style.borderRadius = '5px';
            loadingDiv.style.zIndex = '1000';
            loadingDiv.innerHTML = 'Fetching current exchange rates...';
            document.body.appendChild(loadingDiv);

            // Fetch exchange rates
            await fetchExchangeRates();
            
            // Remove loading indicator
            loadingDiv.remove();
            
            // Update currency labels
            updateCurrencyLabels();
            
            // Add last updated timestamp
            const timestampDiv = document.createElement('div');
            timestampDiv.id = 'lastUpdated';
            timestampDiv.style.position = 'fixed';
            timestampDiv.style.top = '10px';
            timestampDiv.style.right = '10px';
            timestampDiv.style.padding = '10px';
            timestampDiv.style.background = '#f8f9ff';
            timestampDiv.style.color = '#26658C';
            timestampDiv.style.borderRadius = '5px';
            timestampDiv.style.fontSize = '0.8em';
            timestampDiv.style.zIndex = '1000';
            timestampDiv.innerHTML = 'Exchange rates last updated: ' + new Date().toLocaleString();
            document.body.appendChild(timestampDiv);
        };

        // Add refresh button to update rates manually
        const refreshButton = document.createElement('button');
        refreshButton.innerHTML = 'üîÑ Update Exchange Rates';
        refreshButton.className = 'btn btn-secondary';
        refreshButton.style.position = 'fixed';
        refreshButton.style.top = '50px';
        refreshButton.style.right = '10px';
        refreshButton.style.padding = '5px 10px';
        refreshButton.style.fontSize = '0.8em';
        refreshButton.style.zIndex = '1000';
        refreshButton.onclick = async function() {
            this.disabled = true;
            this.innerHTML = 'üîÑ Updating...';
            await fetchExchangeRates();
            document.getElementById('lastUpdated').innerHTML = 'Exchange rates last updated: ' + new Date().toLocaleString();
            this.disabled = false;
            this.innerHTML = 'üîÑ Update Exchange Rates';
        };
        document.body.appendChild(refreshButton);
    </script>
</body>
</html>